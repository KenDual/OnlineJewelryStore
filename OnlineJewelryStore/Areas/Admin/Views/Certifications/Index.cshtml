@model IEnumerable<OnlineJewelryStore.Models.Certification>

@{
    ViewBag.Title = "Index";
    Layout = "~/Areas/Admin/Views/Shared/_LayoutAdmin.cshtml";
}

<style>
    .cert-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 2rem;
        border-radius: 15px 15px 0 0;
        margin-bottom: 0;
        box-shadow: 0 4px 6px rgba(102, 126, 234, 0.2);
    }

    .cert-info-card {
        background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        border-radius: 0 0 15px 15px;
        padding: 1.5rem;
        margin-bottom: 2rem;
        border: none;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
    }

    .cert-badge {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 0.4rem 1rem;
        border-radius: 25px;
        font-weight: 600;
        font-size: 0.9rem;
        box-shadow: 0 2px 4px rgba(102, 126, 234, 0.3);
    }

    .certifier-badge-gia {
        background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
        color: white;
        padding: 0.4rem 1rem;
        border-radius: 20px;
        font-weight: 600;
        box-shadow: 0 2px 4px rgba(17, 153, 142, 0.3);
    }

    .certifier-badge-ags {
        background: linear-gradient(135deg, #4e54c8 0%, #8f94fb 100%);
        color: white;
        padding: 0.4rem 1rem;
        border-radius: 20px;
        font-weight: 600;
        box-shadow: 0 2px 4px rgba(78, 84, 200, 0.3);
    }

    .certifier-badge-other {
        background: linear-gradient(135deg, #757f9a 0%, #d7dde8 100%);
        color: #333;
        padding: 0.4rem 1rem;
        border-radius: 20px;
        font-weight: 600;
        box-shadow: 0 2px 4px rgba(117, 127, 154, 0.3);
    }

    .cert-table {
        background: white;
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
    }

        .cert-table thead {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

            .cert-table thead th {
                border: none;
                padding: 1rem;
                font-weight: 600;
            }

        .cert-table tbody td {
            padding: 1rem;
            vertical-align: middle;
        }

        .cert-table tbody tr:hover {
            background-color: #f8f9fa;
            transition: all 0.3s ease;
        }

    .empty-state {
        text-align: center;
        padding: 4rem 2rem;
        background: white;
        border-radius: 15px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
    }

        .empty-state i {
            font-size: 5rem;
            color: #667eea;
            opacity: 0.3;
            margin-bottom: 1.5rem;
        }

    .btn-action-group {
        display: flex;
        gap: 0.5rem;
        flex-wrap: wrap;
    }

    .verification-link {
        color: #667eea;
        text-decoration: none;
        font-weight: 500;
        transition: all 0.3s ease;
    }

        .verification-link:hover {
            color: #764ba2;
            text-decoration: underline;
        }

    .cert-number-display {
        font-family: 'Courier New', monospace;
        background: #f8f9fa;
        padding: 0.3rem 0.6rem;
        border-radius: 5px;
        font-weight: 600;
        color: #495057;
    }
</style>

@* Breadcrumb *@
<nav aria-label="breadcrumb" style="margin-bottom: 1.5rem;">
    <ol class="breadcrumb">
        <li class="breadcrumb-item">
            <a href="@Url.Action("Index", "Products")">Products</a>
        </li>
        <li class="breadcrumb-item">
            <a href="@Url.Action("Details", "Products", new { id = ViewBag.ProductID })">@ViewBag.ProductName</a>
        </li>
        <li class="breadcrumb-item">
            <a href="@Url.Action("Index", "ProductVariants", new { productId = ViewBag.ProductID })">Variants</a>
        </li>
        <li class="breadcrumb-item">
            <a href="@Url.Action("Index", "Certifications", new { variantId = ViewBag.VariantID })">SKU: @ViewBag.SKU</a>
        </li>
        <li class="breadcrumb-item active" aria-current="page">Certifications</li>
    </ol>
</nav>

@* Success/Error Messages *@
@if (TempData["SuccessMessage"] != null)
{
    <div class="alert alert-success alert-dismissible fade show" role="alert">
        <i class="bi bi-check-circle-fill me-2"></i>
        <strong>Success!</strong> @TempData["SuccessMessage"]
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
}

@if (TempData["ErrorMessage"] != null)
{
    <div class="alert alert-danger alert-dismissible fade show" role="alert">
        <i class="bi bi-exclamation-triangle-fill me-2"></i>
        <strong>Error!</strong> @TempData["ErrorMessage"]
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
}

@* Header *@
<div class="cert-header">
    <div class="d-flex justify-content-between align-items-center flex-wrap">
        <div>
            <h2 class="mb-2">
                <i class="bi bi-award-fill me-2"></i>Product Certifications
            </h2>
            <p class="mb-0 opacity-75">
                Manage gemstone certificates and authenticity documents for this product variant
            </p>
        </div>
        <div class="mt-3 mt-md-0">
            <a href="@Url.Action("Create", new { variantId = ViewBag.VariantID })"
               class="btn btn-light btn-lg">
                <i class="bi bi-plus-circle me-2"></i>Add New Certification
            </a>
        </div>
    </div>
</div>

@* Product & Variant Info Card *@
<div class="cert-info-card">
    <div class="row g-3">
        <div class="col-md-6">
            <div class="d-flex align-items-center mb-2">
                <i class="bi bi-box-seam text-primary me-2" style="font-size: 1.2rem;"></i>
                <strong>Product:</strong>
                <span class="ms-2">@ViewBag.ProductName</span>
            </div>
            <div class="d-flex align-items-center mb-2">
                <i class="bi bi-tag text-success me-2" style="font-size: 1.2rem;"></i>
                <strong>Category:</strong>
                <span class="ms-2">@ViewBag.CategoryName</span>
            </div>
        </div>
        <div class="col-md-6">
            <div class="d-flex align-items-center mb-2">
                <i class="bi bi-upc-scan text-info me-2" style="font-size: 1.2rem;"></i>
                <strong>SKU:</strong>
                <span class="ms-2">@ViewBag.SKU</span>
            </div>
            <div class="d-flex align-items-center mb-2">
                <i class="bi bi-gem text-warning me-2" style="font-size: 1.2rem;"></i>
                <strong>Metal:</strong>
                <span class="ms-2">
                    @(ViewBag.MetalType ?? "N/A")
                    @(ViewBag.Purity != null ? $"({ViewBag.Purity})" : "")
                </span>
            </div>
        </div>
    </div>

    <div class="mt-3 d-flex justify-content-between align-items-center">
        <div>
            <span class="cert-badge">
                <i class="bi bi-award me-1"></i>
                @Model.Count() @(Model.Count() == 1 ? "Certification" : "Certifications")
            </span>
        </div>
        <a href="@Url.Action("Index", "ProductVariants", new { productId = ViewBag.ProductID })"
           class="btn btn-sm btn-outline-secondary">
            <i class="bi bi-arrow-left me-1"></i>Back to Variants
        </a>
    </div>
</div>

@* Certifications Table or Empty State *@
@if (Model.Any())
{
    <div class="cert-table">
        <table class="table table-hover mb-0">
            <thead>
                <tr>
                    <th style="width: 5%;">#</th>
                    <th style="width: 15%;">Certifier</th>
                    <th style="width: 25%;">Certificate Number</th>
                    <th style="width: 35%;">Verification URL</th>
                    <th style="width: 20%;" class="text-center">Actions</th>
                </tr>
            </thead>
            <tbody>
                @{
                    int index = 1;
                }
                @foreach (var item in Model)
                {
                    <tr>
                        <td>
                            <strong class="text-muted">@index</strong>
                        </td>
                        <td>
                            @if (item.Certifier == "GIA")
                            {
                                <span class="certifier-badge-gia">
                                    <i class="bi bi-shield-check me-1"></i>GIA
                                </span>
                            }
                            else if (item.Certifier == "AGS")
                            {
                                <span class="certifier-badge-ags">
                                    <i class="bi bi-shield-check me-1"></i>AGS
                                </span>
                            }
                            else
                            {
                                <span class="certifier-badge-other">
                                    <i class="bi bi-shield me-1"></i>Other
                                </span>
                            }
                        </td>
                        <td>
                            @if (!string.IsNullOrEmpty(item.CertificateNumber))
                            {
                                <span class="cert-number-display">
                                    @item.CertificateNumber
                                </span>
                            }
                            else
                            {
                                <span class="text-muted fst-italic">N/A</span>
                            }
                        </td>
                        <td>
                            @if (!string.IsNullOrEmpty(item.VerificationURL))
                            {
                                <a href="@item.VerificationURL"
                                   target="_blank"
                                   class="verification-link"
                                   title="Open verification link">
                                    <i class="bi bi-link-45deg me-1"></i>
                                    @(item.VerificationURL.Length > 50 ?
                                      item.VerificationURL.Substring(0, 47) + "..." :
                                      item.VerificationURL)
                                    <i class="bi bi-box-arrow-up-right ms-1" style="font-size: 0.8rem;"></i>
                                </a>
                            }
                            else
                            {
                                <span class="text-muted fst-italic">No URL provided</span>
                            }
                        </td>
                        <td class="text-center">
                            <div class="btn-action-group justify-content-center">
                                <a href="@Url.Action("Edit", new { id = item.CertificationID })"
                                   class="btn btn-sm btn-outline-primary"
                                   title="Edit certification">
                                    <i class="bi bi-pencil-square"></i> Edit
                                </a>
                                <a href="@Url.Action("Delete", new { id = item.CertificationID })"
                                   class="btn btn-sm btn-outline-danger"
                                   title="Delete certification">
                                    <i class="bi bi-trash"></i> Delete
                                </a>
                            </div>
                        </td>
                    </tr>
                    index++;
                }
            </tbody>
        </table>
    </div>
}
else
{
    <div class="empty-state">
        <i class="bi bi-award"></i>
        <h4 class="text-muted mb-3">No Certifications Yet</h4>
        <p class="text-muted mb-4">
            This product variant doesn't have any certifications.<br />
            Add gemstone certificates to enhance product authenticity and trust.
        </p>
        <a href="@Url.Action("Create", new { variantId = ViewBag.VariantID })"
           class="btn btn-primary btn-lg">
            <i class="bi bi-plus-circle me-2"></i>Add First Certification
        </a>
    </div>
}

@* Info Box *@
<div class="alert alert-info mt-4" role="alert">
    <i class="bi bi-info-circle-fill me-2"></i>
    <strong>About Certifications:</strong>
    <ul class="mb-0 mt-2">
        <li><strong>GIA</strong> - Gemological Institute of America (World's leading authority)</li>
        <li><strong>AGS</strong> - American Gem Society (Premium certification)</li>
        <li><strong>Other</strong> - Alternative certification providers</li>
        <li>Certificate Number must be <strong>unique</strong> across all certifications</li>
        <li>Verification URL allows customers to verify authenticity online</li>
    </ul>
</div>

@section Scripts {
    <script>
        // Auto-hide alerts after 5 seconds
        setTimeout(function () {
            $('.alert-dismissible').alert('close');
        }, 5000);
    </script>
}